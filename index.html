<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Motor Data Logger</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background-color: #f9f9f9;
    }
    h1, h2 {
      color: #333;
    }
    .section {
      margin-bottom: 40px;
    }
    label {
      display: block;
      margin: 10px 0 4px;
    }
    input, select, textarea {
      padding: 8px;
      width: 300px;
      max-width: 100%;
    }
    button {
      padding: 10px 20px;
      margin-top: 10px;
      background-color: #4CAF50;
      border: none;
      color: white;
      cursor: pointer;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    table, th, td {
      border: 1px solid #aaa;
    }
    th, td {
      padding: 10px;
      text-align: left;
    }
    #motorForm, #passwordSection, #filterSection, #motorLogSection {
      display: none;
    }
  </style>
</head>
<body>

  <h1>üîå Motor Data Logger</h1>

  <!-- Action Selection -->
  <div class="section">
    <label><strong>Select Action:</strong></label>
    <select id="actionSelect" onchange="handleAction(this.value)">
      <option value="">-- Choose --</option>
      <option value="viewAll">üìÑ View All Motors</option>
      <option value="viewOne">üîç View Specific Motor</option>
      <option value="edit">‚úèÔ∏è Add / Edit Motor</option>
    </select>
  </div>

  <!-- View One Filter -->
  <div class="section" id="filterSection">
    <label>Enter Motor Tag to View:</label>
    <input type="text" id="filterInput" oninput="filterMotors()">
  </div>

  <!-- Password Prompt -->
  <div class="section" id="passwordSection">
    <label>Enter Password:</label>
    <input type="password" id="passwordInput">
    <button onclick="checkPassword()">Submit</button>
  </div>

  <!-- Add/Edit Form -->
  <div class="section">
    <form id="motorForm">
      <h2>‚úèÔ∏è Add / Update Motor</h2>
      <label>Date:</label>
      <input type="date" id="date" required>

      <label>Motor Tag:</label>
      <input type="text" id="tag" required>

      <label>FLC (A):</label>
      <input type="text" id="flc">

      <label>NLC (A):</label>
      <input type="text" id="nlc">

      <label>Rated Voltage (V):</label>
      <input type="text" id="voltage">

      <label>Direction of Rotation:</label>
      <input type="text" id="rotation">

      <label>Temp DE Start (¬∞C):</label>
      <input type="text" id="temp_de_start">

      <label>Temp DE End (¬∞C):</label>
      <input type="text" id="temp_de_end">

      <label>Winding Temp Start (¬∞C):</label>
      <input type="text" id="winding_start">

      <label>Winding Temp End (¬∞C):</label>
      <input type="text" id="winding_end">

      <label>Temp NDE Start (¬∞C):</label>
      <input type="text" id="temp_nde_start">

      <label>Temp NDE End (¬∞C):</label>
      <input type="text" id="temp_nde_end">

      <label>Abnormal Sound:</label>
      <select id="sound">
        <option value="No">No</option>
        <option value="Yes">Yes</option>
      </select>

      <label>Remarks:</label>
      <textarea id="remarks"></textarea>

      <br>
      <button type="submit">üíæ Save / Update</button>
    </form>
  </div>

  <!-- Motor Log Table -->
  <div class="section" id="motorLogSection">
    <h2>üìÑ Motor Log</h2>
    <table id="motorTable">
      <thead>
        <tr>
          <th>Date</th>
          <th>Tag</th>
          <th>FLC</th>
          <th>NLC</th>
          <th>Voltage</th>
          <th>Rotation</th>
          <th>DE Start</th>
          <th>DE End</th>
          <th>Winding Start</th>
          <th>Winding End</th>
          <th>NDE Start</th>
          <th>NDE End</th>
          <th>Sound</th>
          <th>Remarks</th>
          <th>Edit</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const form = document.getElementById("motorForm");
    const tableBody = document.querySelector("#motorTable tbody");
    const filterInput = document.getElementById("filterInput");

    function loadMotors(filter = "") {
      const motors = JSON.parse(localStorage.getItem("motors")) || [];
      tableBody.innerHTML = "";

      const filtered = motors.filter(m =>
        m.tag.toLowerCase().includes(filter.toLowerCase())
      );

      filtered.forEach((m, i) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${m.date}</td>
          <td>${m.tag}</td>
          <td>${m.flc}</td>
          <td>${m.nlc}</td>
          <td>${m.voltage}</td>
          <td>${m.rotation}</td>
          <td>${m.temp_de_start}</td>
          <td>${m.temp_de_end}</td>
          <td>${m.winding_start}</td>
          <td>${m.winding_end}</td>
          <td>${m.temp_nde_start}</td>
          <td>${m.temp_nde_end}</td>
          <td>${m.sound}</td>
          <td>${m.remarks}</td>
          <td><button onclick="editMotor(${i})">Edit</button></td>
        `;
        tableBody.appendChild(row);
      });
    }

    function editMotor(index) {
      const motors = JSON.parse(localStorage.getItem("motors")) || [];
      const m = motors[index];
      document.getElementById("date").value = m.date;
      document.getElementById("tag").value = m.tag;
      document.getElementById("flc").value = m.flc;
      document.getElementById("nlc").value = m.nlc;
      document.getElementById("voltage").value = m.voltage;
      document.getElementById("rotation").value = m.rotation;
      document.getElementById("temp_de_start").value = m.temp_de_start;
      document.getElementById("temp_de_end").value = m.temp_de_end;
      document.getElementById("winding_start").value = m.winding_start;
      document.getElementById("winding_end").value = m.winding_end;
      document.getElementById("temp_nde_start").value = m.temp_nde_start;
      document.getElementById("temp_nde_end").value = m.temp_nde_end;
      document.getElementById("sound").value = m.sound;
      document.getElementById("remarks").value = m.remarks;
    }

    form.onsubmit = function (e) {
      e.preventDefault();
      const motors = JSON.parse(localStorage.getItem("motors")) || [];
      const tag = document.getElementById("tag").value;
      const existingIndex = motors.findIndex(m => m.tag === tag);

      const newMotor = {
        date: document.getElementById("date").value,
        tag,
        flc: document.getElementById("flc").value,
        nlc: document.getElementById("nlc").value,
        voltage: document.getElementById("voltage").value,
        rotation: document.getElementById("rotation").value,
        temp_de_start: document.getElementById("temp_de_start").value,
        temp_de_end: document.getElementById("temp_de_end").value,
        winding_start: document.getElementById("winding_start").value,
        winding_end: document.getElementById("winding_end").value,
        temp_nde_start: document.getElementById("temp_nde_start").value,
        temp_nde_end: document.getElementById("temp_nde_end").value,
        sound: document.getElementById("sound").value,
        remarks: document.getElementById("remarks").value
      };

      if (existingIndex >= 0) {
        motors[existingIndex] = newMotor;
      } else {
        motors.push(newMotor);
      }

      localStorage.setItem("motors", JSON.stringify(motors));
      form.reset();
      loadMotors();
      document.getElementById("motorLogSection").style.display = "block";
    };

    function handleAction(action) {
      form.style.display = "none";
      document.getElementById("passwordSection").style.display = "none";
      document.getElementById("filterSection").style.display = "none";
      document.getElementById("motorLogSection").style.display = "none";

      if (action === "edit") {
        document.getElementById("passwordSection").style.display = "block";
      } else if (action === "viewOne") {
        document.getElementById("filterSection").style.display = "block";
        document.getElementById("motorLogSection").style.display = "block";
        filterInput.value = "";
        loadMotors(""); // load all for filtering
      } else if (action === "viewAll") {
        document.getElementById("motorLogSection").style.display = "block";
        loadMotors(); // load all motors
      }
    }

    function checkPassword() {
      const pass = document.getElementById("passwordInput").value;
      if (pass === "area123") {
        form.style.display = "block";
        document.getElementById("passwordSection").style.display = "none";
      } else {
        alert("Incorrect password!");
      }
    }

    function filterMotors() {
      loadMotors(filterInput.value);
    }
  </script>

</body>
</html>
